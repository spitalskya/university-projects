class Mapa:
    def __init__(self):
        self.bus, self.tram, self.taxi, self.sail, self.two = 0, 1, 2, 3, 4

        self.lod = {
            16: {38},
            38: {16, 80},
            80: {38, 161},
            161: {80}
        }

        self.plocha = {
            1: {
                0: {2, 17, 18},
                1: set(),
                2: set(),
            },
            2: {
                0: {1, 3, 19},
                1: {6, 17},
                2: {6, 42},
            },
            3: {
                0: {2, 4},
                1: set(),
                2: set(),
            },
            4: {
                0: {3, 5},
                1: set(),
                2: set(),
            },
            5: {
                0: {4, 6, 21},
                1: set(),
                2: set(),
            },
            6: {
                0: {5, 7, 21, 23, 22, 34},
                1: {2, 31, 34, 9},
                2: {2, 61},
            },
            7: {
                0: {6, 8, 23},
                1: set(),
                2: set(),
            },
            8: {
                0: {7, 23, 24, 9},
                1: set(),
                2: set(),
            },
            9: {
                0: {8, 25, 10},
                1: {6, 38, 12},
                2: set(),
            },
            10: {
                0: {9, 26, 11},
                1: set(),
                2: set(),
            },
            11: {
                0: {10, 12},
                1: set(),
                2: set(),
            },
            12: {
                0: {11, 26, 28, 13},
                1: {9, 15},
                2: set(),
            },
            13: {
                0: {12, 28, 15},
                1: set(),
                2: set(),
            },
            14: {
                0: {15, 28, 29},
                1: set(),
                2: set(),
            },
            15: {
                0: {13, 14, 16},
                1: {12, 16},
                2: set(),
            },
            16: {
                0: {15, 29, 54},
                1: {15, 29, 54},
                2: {29, 54},
            },
            17: {
                0: {1, 30},
                1: {2, 31, 45},
                2: set(),
            },
            18: {
                0: {1, 19, 30},
                1: set(),
                2: set(),
            },
            19: {
                0: {2, 18, 31, 20},
                1: set(),
                2: set(),
            },
            20: {
                0: {19, 31, 43, 32, 21},
                1: set(),
                2: set(),
            },
            21: {
                0: {5, 6, 20, 22},
                1: set(),
                2: set(),
            },
            22: {
                0: {21, 6, 33},
                1: set(),
                2: set(),
            },
            23: {
                0: {6, 7, 8, 36},
                1: set(),
                2: set(),
            },
            24: {
                0: {8, 25, 36},
                1: set(),
                2: set(),
            },
            25: {
                0: {9, 24, 26, 38, 37},
                1: set(),
                2: set(),
            },
            26: {
                0: {10, 25, 12, 27},
                1: set(),
                2: set(),
            },
            27: {
                0: {26, 28, 38},
                1: set(),
                2: set(),
            },
            28: {
                0: {12, 13, 14, 27, 29},
                1: set(),
                2: set(),
            },
            29: {
                0: {14, 28, 16, 53},
                1: {16, 38, 53},
                2: {16, 38, 112},
            },
            30: {
                0: {17, 18, 31, 39, 40},
                1: set(),
                2: set(),
            },
            31: {
                0: {19, 20, 30, 41, 42},
                1: {6, 17, 45},
                2: set(),
            },
            32: {
                0: {20, 33, 44},
                1: set(),
                2: set(),
            },
            33: {
                0: {22, 32, 44, 34},
                1: set(),
                2: set(),
            },
            34: {
                0: {6, 33, 35, 48, 44},
                1: {6, 61, 42},
                2: set(),
            },
            35: {
                0: {34, 36, 37},
                1: set(),
                2: set(),
            },
            36: {
                0: {23, 24, 35, 37},
                1: set(),
                2: set(),
            },
            37: {
                0: {35, 36, 25, 49},
                1: set(),
                2: set(),
            },
            38: {
                0: {25, 27, 49, 50},
                1: {9, 29, 61, 80, 53},
                2: {29, 61, 80},
            },
            39: {
                0: {30, 40, 45},
                1: set(),
                2: set(),
            },
            40: {
                0: {30, 39, 41, 45, 56},
                1: set(),
                2: set(),
            },
            41: {
                0: {31, 40, 42, 46, 56},
                1: set(),
                2: set(),
            },
            42: {
                0: {31, 41, 43, 46},
                1: {34, 45, 74},
                2: {2, 45},
            },
            43: {
                0: {42, 20, 44, 46},
                1: set(),
                2: set(),
            },
            44: {
                0: {32, 33, 34, 43, 46, 47},
                1: set(),
                2: set(),
            },
            45: {
                0: {39, 40, 55, 72, 56},
                1: {17, 42, 31, 73},
                2: {42, 74, 114},
            },
            46: {
                0: {41, 42, 43, 44, 58, 59},
                1: set(),
                2: set(),
            },
            47: {
                0: {44, 48, 60, 59},
                1: set(),
                2: set(),
            },
            48: {
                0: {34, 47, 61},
                1: set(),
                2: set(),
            },
            49: {
                0: {37, 38, 61},
                1: set(),
                2: set(),
            },
            50: {
                0: {38, 51, 62, 63},
                1: set(),
                2: set(),
            },
            51: {
                0: {50, 52, 63, 64},
                1: set(),
                2: set(),
            },
            52: {
                0: {51, 65, 53},
                1: set(),
                2: set(),
            },
            53: {
                0: {29, 52, 65, 67, 54},
                1: {29, 38, 80, 54, 89},
                2: set(),
            },
            54: {
                0: {16, 53, 68, 70},
                1: {16, 53, 91, 150},
                2: {16, 112},
            },
            55: {
                0: {45, 72, 71},
                1: set(),
                2: set(),
            },
            56: {
                0: {40, 41, 45, 72, 57},
                1: set(),
                2: set(),
            },
            57: {
                0: {56, 58, 73},
                1: set(),
                2: set(),
            },
            58: {
                0: {46, 59, 57, 74},
                1: set(),
                2: set(),
            },
            59: {
                0: {46, 47, 58, 76},
                1: set(),
                2: set(),
            },
            60: {
                0: {47, 61, 76, 77},
                1: set(),
                2: set(),
            },
            61: {
                0: {48, 49, 60, 79},
                1: {34, 75, 38},
                2: {74, 80, 6, 38},
            },
            62: {
                0: {50, 63, 80},
                1: set(),
                2: set(),
            },
            63: {
                0: {50, 51, 62, 64, 82},
                1: set(),
                2: set(),
            },
            64: {
                0: {51, 63, 84, 65, 85},
                1: set(),
                2: set(),
            },
            65: {
                0: {52, 53, 64, 85, 66},
                1: set(),
                2: set(),
            },
            66: {
                0: {65, 88, 85},
                1: set(),
                2: set(),
            },
            67: {
                0: {53, 68, 69, 89},
                1: set(),
                2: set(),
            },
            68: {
                0: {54, 67, 69},
                1: set(),
                2: set(),
            },
            69: {
                0: {68, 70, 67, 91},
                1: set(),
                2: set(),
            },
            70: {
                0: {54, 69, 93},
                1: set(),
                2: set(),
            },
            71: {
                0: {55, 72, 94},
                1: set(),
                2: set(),
            },
            72: {
                0: {45, 55, 56, 71, 73},
                1: set(),
                2: set(),
            },
            73: {
                0: {72, 57, 94, 74},
                1: {45, 114, 74},
                2: set(),
            },
            74: {
                0: {73, 58, 75, 97},
                1: {42, 73, 75},
                2: {45, 61, 99},
            },
            75: {
                0: {74, 76, 98, 100},
                1: {74, 61},
                2: set(),
            },
            76: {
                0: {59, 60, 75},
                1: set(),
                2: set(),
            },
            77: {
                0: {60, 79, 100, 102},
                1: set(),
                2: set(),
            },
            78: {
                0: {79, 102},
                1: set(),
                2: set(),
            },
            79: {
                0: {61, 77, 78, 80},
                1: {102, 80},
                2: set(),
            },
            80: {
                0: {79, 62, 81, 108, 106, 103},
                1: {79, 38, 53, 110, 104},
                2: {61, 110, 38},
            },
            81: {
                0: {82, 108, 80},
                1: set(),
                2: set(),
            },
            82: {
                0: {63, 84, 83, 81},
                1: set(),
                2: set(),
            },
            83: {
                0: {82, 108, 110, 86},
                1: set(),
                2: set(),
            },
            84: {
                0: {85, 64, 86, 82},
                1: set(),
                2: set(),
            },
            85: {
                0: {66, 65, 64, 84, 86},
                1: set(),
                2: set(),
            },
            86: {
                0: {85, 84, 88, 87, 83, 110},
                1: set(),
                2: set(),
            },
            87: {
                0: {88, 86, 111, 90},
                1: set(),
                2: set(),
            },
            88: {
                0: {89, 66, 86, 87},
                1: set(),
                2: set(),
            },
            89: {
                0: {67, 91, 90, 88},
                1: {53, 110, 112},
                2: set(),
            },
            90: {
                0: {89, 87, 112},
                1: set(),
                2: set(),
            },
            91: {
                0: {69, 89, 93, 92},
                1: {54, 112, 150},
                2: set(),
            },
            92: {
                0: {91, 93, 112, 113},
                1: set(),
                2: set(),
            },
            93: {
                0: {70, 91, 92},
                1: set(),
                2: set(),
            },
            94: {
                0: {71, 73, 114},
                1: set(),
                2: set(),
            },
            95: {
                0: {115, 96},
                1: set(),
                2: set(),
            },
            96: {
                0: {95, 97, 116, 118},
                1: set(),
                2: set(),
            },
            97: {
                0: {74, 98, 96, 118},
                1: set(),
                2: set(),
            },
            98: {
                0: {75, 99, 97},
                1: set(),
                2: set(),
            },
            99: {
                0: {98, 100, 101, 119},
                1: set(),
                2: {74, 159},
            },
            100: {
                0: {75, 77, 102, 99},
                1: set(),
                2: set(),
            },
            101: {
                0: {99, 102, 120},
                1: set(),
                2: set(),
            },
            102: {
                0: {78, 77, 100, 101, 121},
                1: {79, 119, 104},
                2: set(),
            },
            103: {
                0: {80, 104, 106},
                1: set(),
                2: set(),
            },
            104: {
                0: {103, 105, 122, 162},
                1: {80, 162, 102},
                2: set(),
            },
            105: {
                0: {106, 107, 104, 122, 123},
                1: set(),
                2: set(),
            },
            106: {
                0: {108, 80, 103, 105, 107},
                1: set(),
                2: set(),
            },
            107: {
                0: {109, 106, 105, 124},
                1: set(),
                2: set(),
            },
            108: {
                0: {81, 83, 80, 106, 109, 110},
                1: set(),
                2: set(),
            },
            109: {
                0: {108, 107, 110, 125},
                1: set(),
                2: set(),
            },
            110: {
                0: {83, 86, 111, 127, 126, 109, 108},
                1: {89, 129, 144, 80},
                2: {80, 144, 112},
            },
            111: {
                0: {87, 112, 128, 110},
                1: set(),
                2: set(),
            },
            112: {
                0: {90, 92, 113, 131, 111},
                1: {89, 91, 129},
                2: {29, 54, 170, 110},
            },
            113: {
                0: {92, 112, 132},
                1: set(),
                2: set(),
            },
            114: {
                0: {94, 115, 135},
                1: {73, 117},
                2: {45, 175},
            },
            115: {
                0: {95, 114, 116},
                1: set(),
                2: set(),
            },
            116: {
                0: {115, 96, 135, 117},
                1: set(),
                2: set(),
            },
            117: {
                0: {116, 118, 155, 136},
                1: {114, 119, 172},
                2: set(),
            },
            118: {
                0: {96, 97, 117, 119, 137},
                1: set(),
                2: set(),
            },
            119: {
                0: {99, 120, 118, 137, 138},
                1: {102, 117, 159},
                2: set(),
            },
            120: {
                0: {101, 121, 119},
                1: set(),
                2: set(),
            },
            121: {
                0: {102, 120, 140},
                1: set(),
                2: set(),
            },
            122: {
                0: {104, 105, 141},
                1: set(),
                2: set(),
            },
            123: {
                0: {105, 141, 124},
                1: set(),
                2: set(),
            },
            124: {
                0: {107, 123, 125, 142, 143},
                1: {144, 162},
                2: set(),
            },
            125: {
                0: {109, 126, 124, 144},
                1: set(),
                2: set(),
            },
            126: {
                0: {110, 127, 145, 125},
                1: set(),
                2: set(),
            },
            127: {
                0: {110, 128, 129, 126},
                1: set(),
                2: set(),
            },
            128: {
                0: {111, 131, 127},
                1: set(),
                2: set(),
            },
            129: {
                0: {130, 127, 145, 147},
                1: {112, 146, 144, 110},
                2: set(),
            },
            130: {
                0: {129, 131, 148},
                1: set(),
                2: set(),
            },
            131: {
                0: {112, 128, 130, 132, 133},
                1: set(),
                2: set(),
            },
            132: {
                0: {113, 131, 133, 134},
                1: set(),
                2: set(),
            },
            133: {
                0: {131, 132, 149, 148},
                1: set(),
                2: set(),
            },
            134: {
                0: {132, 150},
                1: set(),
                2: set(),
            },
            135: {
                0: {114, 116, 154, 171},
                1: set(),
                2: set(),
            },
            136: {
                0: {117, 156, 157, 158, 137},
                1: set(),
                2: set(),
            },
            137: {
                0: {118, 136, 119, 138, 158},
                1: set(),
                2: set(),
            },
            138: {
                0: {119, 137, 159, 139},
                1: set(),
                2: set(),
            },
            139: {
                0: {138, 140, 161},
                1: set(),
                2: set(),
            },
            140: {
                0: {121, 139, 161},
                1: set(),
                2: set(),
            },
            141: {
                0: {122, 123, 142},
                1: set(),
                2: set(),
            },
            142: {
                0: {141, 124, 163, 162},
                1: set(),
                2: set(),
            },
            143: {
                0: {124, 163, 164, 144},
                1: set(),
                2: set(),
            },
            144: {
                0: {125, 145, 143, 165},
                1: {124, 194, 129, 110},
                2: {162, 196, 110},
            },
            145: {
                0: {126, 129, 144, 146},
                1: set(),
                2: set(),
            },
            146: {
                0: {145, 147, 168, 167, 166},
                1: {129, 194},
                2: set(),
            },
            147: {
                0: {129, 148, 146, 151},
                1: set(),
                2: set(),
            },
            148: {
                0: {130, 147, 149, 133},
                1: set(),
                2: set(),
            },
            149: {
                0: {148, 133, 151, 152},
                1: set(),
                2: set(),
            },
            150: {
                0: {134, 152},
                1: {91, 54, 170},
                2: set(),
            },
            151: {
                0: {147, 149, 153},
                1: set(),
                2: set(),
            },
            152: {
                0: {149, 150, 153, 170},
                1: set(),
                2: set(),
            },
            153: {
                0: {151, 168, 152, 170},
                1: set(),
                2: set(),
            },
            154: {
                0: {135, 171},
                1: set(),
                2: set(),
            },
            155: {
                0: {117, 156},
                1: set(),
                2: set(),
            },
            156: {
                0: {155, 172, 157, 136},
                1: set(),
                2: set(),
            },
            157: {
                0: {156, 172, 173, 177, 136},
                1: set(),
                2: set(),
            },
            158: {
                0: {136, 137, 159, 177},
                1: set(),
                2: set(),
            },
            159: {
                0: {158, 138, 180, 160},
                1: {119, 161, 177},
                2: {175, 162, 99},
            },
            160: {
                0: {159, 161, 181},
                1: set(),
                2: set(),
            },
            161: {
                0: {139, 160, 162, 181, 140},
                1: {159, 162},
                2: set(),
            },
            162: {
                0: {161, 104, 142, 163, 186, 185},
                1: {161, 187, 104, 124},
                2: {159, 144, 196},
            },
            163: {
                0: {162, 142, 143, 186, 190},
                1: set(),
                2: set(),
            },
            164: {
                0: {143, 190, 192, 165},
                1: set(),
                2: set(),
            },
            165: {
                0: {144, 164, 192, 194, 166},
                1: set(),
                2: set(),
            },
            166: {
                0: {165, 194, 167, 146},
                1: set(),
                2: set(),
            },
            167: {
                0: {166, 146, 168, 197},
                1: set(),
                2: set(),
            },
            168: {
                0: {146, 153, 167, 199, 169},
                1: {198, 170},
                2: set(),
            },
            169: {
                0: {168, 170, 201, 200},
                1: set(),
                2: set(),
            },
            170: {
                0: {153, 152, 169, 201},
                1: {202, 168, 150},
                2: {196, 112},
            },
            171: {
                0: {154, 135, 172, 174},
                1: set(),
                2: set(),
            },
            172: {
                0: {171, 156, 157, 173},
                1: {117, 177},
                2: set(),
            },
            173: {
                0: {172, 157, 176, 175},
                1: set(),
                2: set(),
            },
            174: {
                0: {171, 175},
                1: set(),
                2: set(),
            },
            175: {
                0: {174, 173, 176},
                1: set(),
                2: {114, 159},
            },
            176: {
                0: {173, 175, 177},
                1: set(),
                2: set(),
            },
            177: {
                0: {176, 157, 158, 179, 178},
                1: {172, 159},
                2: set(),
            },
            178: {
                0: {177, 183},
                1: set(),
                2: set(),
            },
            179: {
                0: {177, 180, 182, 183},
                1: set(),
                2: set(),
            },
            180: {
                0: {159, 179, 181, 182},
                1: set(),
                2: set(),
            },
            181: {
                0: {160, 161, 180, 182},
                1: set(),
                2: set(),
            },
            182: {
                0: {180, 181, 179, 184},
                1: set(),
                2: set(),
            },
            183: {
                0: {179, 178, 184},
                1: set(),
                2: set(),
            },
            184: {
                0: {183, 182},
                1: set(),
                2: set(),
            },
            185: {
                0: {162, 186, 188, 187},
                1: set(),
                2: set(),
            },
            186: {
                0: {162, 185, 188, 163},
                1: set(),
                2: set(),
            },
            187: {
                0: {185, 189},
                1: {162, 196},
                2: set(),
            },
            188: {
                0: {185, 186, 190, 189},
                1: set(),
                2: set(),
            },
            189: {
                0: {187, 188, 191},
                1: set(),
                2: set(),
            },
            190: {
                0: {163, 164, 188, 191},
                1: set(),
                2: set(),
            },
            191: {
                0: {190, 192, 189, 193},
                1: set(),
                2: set(),
            },
            192: {
                0: {164, 165, 191, 194},
                1: set(),
                2: set(),
            },
            193: {
                0: {191, 194, 196},
                1: set(),
                2: set(),
            },
            194: {
                0: {192, 165, 166, 195, 193},
                1: {144, 146, 196},
                2: set(),
            },
            195: {
                0: {194, 196, 197},
                1: set(),
                2: set(),
            },
            196: {
                0: {195, 193, 197},
                1: {194, 187, 198},
                2: {162, 144, 170},
            },
            197: {
                0: {195, 196, 167, 198},
                1: set(),
                2: set(),
            },
            198: {
                0: {197, 199, 200},
                1: {196, 202, 168},
                2: set(),
            },
            199: {
                0: {198, 168},
                1: set(),
                2: set(),
            },
            200: {
                0: {198, 169, 201, 202},
                1: set(),
                2: set(),
            },
            201: {
                0: {169, 170, 200, 202},
                1: set(),
                2: set(),
            },
            202: {
                0: {200, 201},
                1: {198, 170},
                2: set(),
            }
        }

    def exists_path(self, point_a, point_b, way=None):  # None su tri zakladne prostriedky
        if way is None:
            return point_b in self.plocha[point_a][self.bus] or point_b in self.plocha[point_a][self.tram] or point_b in \
                   self.plocha[point_a][self.taxi]
        else:
            if way == self.sail:
                return self.exists_sail(point_a, point_b)
            else:
                return point_b in self.plocha[point_a][way]

    def exists_sail(self, point_a, point_b):
        if point_a in self.lod.keys():
            return point_b in self.lod[point_a]
        else:
            return False

    def shortest_path_bfs(self, graph, node_start, node_end, only=None):  # function for BFS
        if only is None:
            for vertex in graph:
                graph[vertex]['adj'] = graph[vertex][0] | graph[vertex][1] | graph[vertex][2]
                # zjednotenie vsetkych susedov
            through = 'adj'
        else:
            through = only

        visited = []
        queue = []
        paths = []

        visited.append(node_start)
        queue.append(node_start)

        while queue:  # Creating loop to visit each node
            m = queue.pop(0)

            for neighbour in graph[m][through]:
                if neighbour not in visited:
                    visited.append(neighbour)
                    queue.append(neighbour)

                    for path in paths:  # najde cestu k m, pripoji neighbour
                        if path[-1][0] == m:
                            if neighbour in graph[m][0] and (through == 0 or through == 'adj'):
                                # najprv nech ide prostriedkom 0, potom 1 a nakoniec 2

                                paths.append(path + [(neighbour, 0)])
                                break
                            elif neighbour in graph[m][1] and (through == 1 or through == 'adj'):
                                paths.append(path + [(neighbour, 1)])
                                break
                            elif neighbour in graph[m][2] and (through == 2 or through == 'adj'):
                                paths.append(path + [(neighbour, 2)])
                                break
                    else:  # ak nie je cesta k m, vytvori cestu
                        if neighbour in graph[m][0] and (through == 0 or through == 'adj'):
                            paths.append([(m, None), (neighbour, 0)])
                        elif neighbour in graph[m][1] and (through == 1 or through == 'adj'):
                            paths.append([(m, None), (neighbour, 1)])
                        elif neighbour in graph[m][2] and (through == 2 or through == 'adj'):
                            paths.append([(m, None), (neighbour, 2)])

                if neighbour == node_end:
                    return paths[-1]


if __name__ == '__main__':
    import time

    mapa = Mapa()

    print(mapa.shortest_path_bfs(mapa.plocha, 80, 15))
    test_allPathsTime = 0
    test_pathsDuplex = 0

    if test_allPathsTime:
        t = time.time()

        for i in range(1, len(mapa.plocha) + 1):
            for j in range(i, len(mapa.plocha) + 1):
                for medium in (mapa.bus, mapa.tram, mapa.taxi, mapa.sail):
                    mapa.exists_path(i, j, medium)

        print(time.time() - t)

    if test_pathsDuplex:
        for i in range(1, len(mapa.plocha) + 1):
            for j in range(1, len(mapa.plocha) + 1):
                for medium in (mapa.bus, mapa.tram, mapa.taxi, mapa.sail):
                    if mapa.exists_path(i, j, medium) and not mapa.exists_path(j, i, medium):
                        print(i, j, medium)
